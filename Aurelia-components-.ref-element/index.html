<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@kabaehr">
    
      <meta name="twitter:title" content="Web dev and more">
    
    
      <meta name="twitter:url" content="http://kabaehr.github.io//Aurelia-components-.ref-element/">
    
    
      <meta name="twitter:description" content="Blog where I share my programming and web development experiences">
    
    
      <meta name="twitter:image:src" content="http://kabaehr.github.io//path/to/image/logo.png">
    
    
    <title>Aurelia Components: The .ref Binding Command</title>
    <title>Web dev and more</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <!-- Come and get me RSS readers -->
    <link rel="alternate" type="application/rss+xml" title="Web dev and more" href="http://kabaehr.github.io//feed.xml" />
    
    <!-- Stylesheet -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="canonical" href="http://kabaehr.github.io//Aurelia-components-.ref-element/">

    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">

  
</head>


<body>

   <div class="header">
    <div class="container">
        <h1 class="logo">
            <a href="/">Web dev and more</a>
        </h1>
        <nav class="nav-collapse">
            <ul class="noList">
                
                
                <li class="element first  ">
                    <a href="/index.html">Home</a>
                </li>
                
                <li class="element   ">
                    <a href="/about">About</a>
                </li>
                
                <li class="element   last">
                    <a href="/impressum">Impressum</a>
                </li>
                
            </ul>
        </nav>
    </div>
</div>


<!-- end .header -->

   <div class="content">
      <div class="container">
         <div class="post">
  
  <h1 class="postTitle">Aurelia Components: The .ref Binding Command</h1>
  <p class="meta">July 16, 2017 
  </p> 
  
  <p><span class="dropcap">T</span>he <code>.ref</code> binding is a quite undervalued feature that can help you with several problems in a clean and nice way. Using .ref can reduce the complexity of your application, save bundle size and performance. I want to show you some examples and how to use it.</p>
<h2>What is .ref</h2>
<p>Since <a href="http://blog.aurelia.io/2015/06/08/aurelia-early-june-release/" title="aurelia blog post about API changes">summer 2015</a> the <code>.ref</code> binding can be used like all other binding commands (<code>one-way, two-way, one-time, call, ...</code>). You can use it to create a reference to an HTML element in the DOM, a view model, a view instance or a controller.
The pattern to use it looks the following: <code>&lt;some-element some-attribute.ref=&quot;expression&quot;&gt;</code>. There are several possibilities for <code>some-attribute</code>. You can use <code>view-model.ref</code>, <code>view.ref</code>, <code>controller.ref</code>, <code>attribute.ref</code>, <code>element.ref</code> and just <code>ref=&quot;expression&quot;</code> which defaults to <code>element.ref</code>. The expression can be a variable but it could also be
an array element or an object.</p>
<p>These informations are also listed in the <a href="http://aurelia.io/hub.html#/doc/article/aurelia/binding/latest/binding-basics/4" title="aurelia binding basics">official documentation</a>.
Have a look at the examples below to get a better understanding how to leverage the <code>.ref</code> binding for your application.</p>
<h2>Why you should use .ref</h2>
<p>Like I already mentioned the <code>.ref</code> binding command can make the usage of jQuery needless, therefore you can save the size of it.
Next, to that, you can reference a lot of elements, view model, view instances or controller without the need of searching/traversing the DOM, building complicated structures, referencing and connecting logic over the parent controller/view or working with obscure events.</p>
<p>This makes your life far easier and gives you a mighty and performant way of wiring your application together.</p>
<h2>When to use .ref</h2>
<p>jQuery is a mighty library that can be used for a variety of use cases. The most common use case is probably to select one single element by some selector and manipulating its DOM or properties. So always when you feel the urge to use jQuery you should think about using .ref instead.</p>
<p>In general, you should use bindables and <a href="http://kabaehr.de/blog/Aurelia-components-function-binding-mit-.call/" title="link to my aurelia .call binding post">.call</a> whenever possible because this is more straightforward, better readable and understandable.</p>
<p>One situation where you have to use jQuery is when you need to select multiple elements or when you integrate a jQuery plugin. Here you often have to do something like <code>$('some-selector').plugin({...})</code> and this will not work if the expression on which you call <code>.plugin({...})</code> is not a jQuery object. But you can use an element reference instead of a selector so it will be converted to a jQuery object <code>$(yourElementRef).plugin({...})</code>.</p>
<p>Another use case is when you want to use some properties from a plugin you don´t have under control. E.g. a 3rd party datepicker where you want to use parts of the selected date to show it below the datepicker itself, but the datepicker doesn´t offer a way to get these properties.</p>
<h2>At what time to use .ref</h2>
You can´t access the referenced element before the <code>bind</code> lifecycle callback is called. In case you want to access the DOM of a referenced element you have to wait until the <code>attached</code> callback got called because the DOM needs to be constructed first. So you can´t use the reference in the constructor.
<h2>How to use .ref</h2>
<p>I put some examples on <a href="https://gist.run/?id=c022f7390f7d0efc5c81c0d79685c6d8" title="gitter gist with .ref examples"> this Gist</a>, you should have a look at them to while reading the next parts.</p>
<h3> Reference Element </h3>
<p>You can use <code>element.ref</code> (or just <code>ref</code>) on every HTMLElement to create a reference to this element. The reference will be of type <a href="https://developer.mozilla.org/en/docs/Web/API/HTMLElement" title="HTMLElement API reference">HTMLElement</a>. Looking at the properties of HTMLElement (Element and Node) we see that we can do a lot of things with it. Finding or selecting a childElement, execute click or blur functions, adding event listeners and much more.</p>
<p>Usage:</p>
<pre class="language-html"><code class="language-html">//app.html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>elementRef<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span> Some text <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<pre class="language-js"><code class="language-js"><span class="token comment">//app.js</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">{</span>
  <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>elementRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>This usage of <code>element.ref</code> is the most common one. You can use it for referencing specific DOM elements in your own custom component too. We are using it a lot when working with <a href="https://d3js.org/" title="d3 chart libary">d3.js</a> or <a href="https://www.w3schools.com/html/html5_canvas.asp" title="HTML Canvas on w3schools">HTML Canvas</a> because you can do things like:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">//some-chart.js</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">SomeChart</span> <span class="token punctuation">{</span>
  <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//canvas</span>
    <span class="token keyword">let</span> diagramContext <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>diagramCanvasRef<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//D3</span>
    <span class="token keyword">let</span> container <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>chartContainerRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3> Reference View </h3>
<p>In difference to <code>element.ref</code>, <code>view.ref</code> can only be applied on custom elements and not on normal HTML elements.</p>
<p>Using <code>view.ref</code> we get access to the Aurelia view instance, having access to several internal properties like the view factory and the bindingContext. <a href="http://aurelia.io/hub.html#/doc/article/aurelia/binding/latest/binding-how-it-works/3" title="aurelia binding in depth">The binding context is almost always a view model instance </a> so we can access the view model too.</p>
<p>Usage:</p>
<pre class="language-html"><code class="language-html">//app.html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-element</span> <span class="token attr-name">view.ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewRef<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>custom-element</span><span class="token punctuation">></span></span>
</code></pre>
<pre class="language-js"><code class="language-js"><span class="token comment">//app.js</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">{</span>
  <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>viewRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>Have a look at the <a href="http://aurelia.io/hub.html#/doc/article/aurelia/binding/latest/binding-how-it-works/1" title="view factory documentation">documentation</a> to understand what you can do with the ViewFactory or see this <a href="https://gist.run/?id=762c00133d5d5be624f9" title="gitter gist with view factory example"> advanced example</a> from an aurelia core team member on how to use the ViewFactory.</p>
<h3>Reference (Attribute) View Model</h3>
<p>Referencing the view model of an element or attribute gives us access to the underlying view model (the class .js file). So we can access all properties and methods and even define new ones.</p>
<p>Usage:</p>
<pre class="language-html"><code class="language-html">//app.html

//element view model
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-element</span> <span class="token attr-name">view-model.ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vmRef<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>custom-element</span><span class="token punctuation">></span></span>

//attribute view model
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">custom-attribute</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>value: 42<span class="token punctuation">"</span></span> <span class="token attr-name">custom-attribute.ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>attributeRef<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>custom-element</span><span class="token punctuation">></span></span>
</code></pre>
<pre class="language-js"><code class="language-js"><span class="token comment">//app.js</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">{</span>
  <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>attributeRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vmRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3> Reference Controller </h3>
<p>The controller owns the view model and the view and composes them together. The controller instance is also responsible for the element´s lifecycle methods and executes them. Therefore referencing the controller gives you access to the view, the view model and the parents view (scope).</p>
<p>Usage:</p>
<pre class="language-html"><code class="language-html">//app.html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-element</span> <span class="token attr-name">controller.ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ctrlRef<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>custom-element</span><span class="token punctuation">></span></span></code></pre>
<pre class="language-js"><code class="language-js"><span class="token comment">//app.js</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">{</span>
  <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ctrlRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p><a href="http://aurelia.io/hub.html#/doc/article/aurelia/binding/latest/binding-how-it-works/1">See the official docs for more explanations about the controller.</a></p>
<h2> Summary </h2>
<p>Some of the examples are really made up because I couldn´t think of a short real world example and the focus lays on showing the syntax and how to access the references in your outer view model. <br>
To summarize you should think about using .ref to select and change the look or behavior of an element/attribute when you can´t customize the element/attribute over bindables.</p>


  <p class="contact-me-box">
  Found some typo, want to give feedback or discuss? Feel free to contact me :)
  </p>

  <!-- POST NAVIGATION -->
  <div class="postNav clearfix">
      
     
  </div>
</div>

      </div>
   </div><!-- end .content -->

   <div class="footer">
   <div class="container">
      <p class="copy">&copy;  Katharina Bähr | Theme by <a href="https://github.com/brianmaierjr/long-haul" target="_blank" alt="link to brianmaierjr on github">brianmaierjr </a></p>
      <div class="footer-links"> 
         <ul class="noList"> 
           
            
            <li><a href="https://twitter.com/">
                  <svg id="twitter" class="custom-icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" style="height: 50px; width: 50px;"><circle class="outer-shape" cx="50" cy="50" r="48" style="opacity: 1;"></circle>
                  <path class="inner-shape" style="opacity: 1;" transform="translate(25,25) scale(0.5)" d="M99.001,19.428c-3.606,1.608-7.48,2.695-11.547,3.184c4.15-2.503,7.338-6.466,8.841-11.189 c-3.885,2.318-8.187,4-12.768,4.908c-3.667-3.931-8.893-6.387-14.676-6.387c-11.104,0-20.107,9.054-20.107,20.223 c0,1.585,0.177,3.128,0.52,4.609c-16.71-0.845-31.525-8.895-41.442-21.131C6.092,16.633,5.1,20.107,5.1,23.813 c0,7.017,3.55,13.208,8.945,16.834c-3.296-0.104-6.397-1.014-9.106-2.529c-0.002,0.085-0.002,0.17-0.002,0.255 c0,9.799,6.931,17.972,16.129,19.831c-1.688,0.463-3.463,0.71-5.297,0.71c-1.296,0-2.555-0.127-3.783-0.363 c2.559,8.034,9.984,13.882,18.782,14.045c-6.881,5.424-15.551,8.657-24.971,8.657c-1.623,0-3.223-0.096-4.796-0.282 c8.898,5.738,19.467,9.087,30.82,9.087c36.982,0,57.206-30.817,57.206-57.543c0-0.877-0.02-1.748-0.059-2.617 C92.896,27.045,96.305,23.482,99.001,19.428z"></path>
                  </svg>
            </a></li>
            
            
            <li><a href="https://github.com/">
                  <svg id="github" class="custom-icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" style="height: 50px; width: 50px;"><circle class="outer-shape" cx="50" cy="50" r="48" style="opacity: 1;"></circle>
                  <path class="inner-shape" style="opacity: 1;" transform="translate(25,25) scale(0.5)" d="M50,1C22.938,1,1,22.938,1,50s21.938,49,49,49s49-21.938,49-49S77.062,1,50,1z M79.099,79.099 c-3.782,3.782-8.184,6.75-13.083,8.823c-1.245,0.526-2.509,0.989-3.79,1.387v-7.344c0-3.86-1.324-6.699-3.972-8.517 c1.659-0.16,3.182-0.383,4.57-0.67c1.388-0.287,2.855-0.702,4.402-1.245c1.547-0.543,2.935-1.189,4.163-1.938 c1.228-0.75,2.409-1.723,3.541-2.919s2.082-2.552,2.847-4.067s1.372-3.334,1.818-5.455c0.446-2.121,0.67-4.458,0.67-7.01 c0-4.945-1.611-9.155-4.833-12.633c1.467-3.828,1.308-7.991-0.478-12.489l-1.197-0.143c-0.829-0.096-2.321,0.255-4.474,1.053 c-2.153,0.798-4.57,2.105-7.249,3.924c-3.797-1.053-7.736-1.579-11.82-1.579c-4.115,0-8.039,0.526-11.772,1.579 c-1.69-1.149-3.294-2.097-4.809-2.847c-1.515-0.75-2.727-1.26-3.637-1.532c-0.909-0.271-1.754-0.439-2.536-0.503 c-0.782-0.064-1.284-0.079-1.507-0.048c-0.223,0.031-0.383,0.064-0.478,0.096c-1.787,4.53-1.946,8.694-0.478,12.489 c-3.222,3.477-4.833,7.688-4.833,12.633c0,2.552,0.223,4.889,0.67,7.01c0.447,2.121,1.053,3.94,1.818,5.455 c0.765,1.515,1.715,2.871,2.847,4.067s2.313,2.169,3.541,2.919c1.228,0.751,2.616,1.396,4.163,1.938 c1.547,0.543,3.014,0.957,4.402,1.245c1.388,0.287,2.911,0.511,4.57,0.67c-2.616,1.787-3.924,4.626-3.924,8.517v7.487 c-1.445-0.43-2.869-0.938-4.268-1.53c-4.899-2.073-9.301-5.041-13.083-8.823c-3.782-3.782-6.75-8.184-8.823-13.083 C9.934,60.948,8.847,55.56,8.847,50s1.087-10.948,3.231-16.016c2.073-4.899,5.041-9.301,8.823-13.083s8.184-6.75,13.083-8.823 C39.052,9.934,44.44,8.847,50,8.847s10.948,1.087,16.016,3.231c4.9,2.073,9.301,5.041,13.083,8.823 c3.782,3.782,6.75,8.184,8.823,13.083c2.143,5.069,3.23,10.457,3.23,16.016s-1.087,10.948-3.231,16.016 C85.848,70.915,82.88,75.317,79.099,79.099L79.099,79.099z"></path>
                  </svg>
            </a></li>
             
            
            <li><a href="mailto:">
                  <svg id="mail" class="custom-icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" style="height: 50px; width: 50px;"><circle class="outer-shape" cx="50" cy="50" r="48" style="opacity: 1;"></circle>
                  <path class="inner-shape" style="opacity: 1;" transform="translate(25,25) scale(0.5)" d="M50,1C22.938,1,1,22.938,1,50s21.938,49,49,49s49-21.938,49-49S77.062,1,50,1z M25.5,25.5h49 c0.874,0,1.723,0.188,2.502,0.542L50,57.544L22.998,26.041C23.777,25.687,24.626,25.499,25.5,25.5L25.5,25.5z M19.375,68.375v-36.75 c0-0.128,0.005-0.256,0.014-0.383l17.96,20.953L19.587,69.958C19.448,69.447,19.376,68.916,19.375,68.375L19.375,68.375z M74.5,74.5 h-49c-0.541,0-1.072-0.073-1.583-0.212l17.429-17.429L50,66.956l8.653-10.096l17.429,17.429C75.572,74.427,75.041,74.5,74.5,74.5 L74.5,74.5z M80.625,68.375c0,0.541-0.073,1.072-0.211,1.583L62.652,52.195l17.96-20.953c0.008,0.127,0.014,0.255,0.014,0.383 L80.625,68.375L80.625,68.375z"></path>
                  </svg>
            </a></li>
            
         </ul>
      </div>
   </div>
</div><!-- end .footer -->


   <!-- Add jQuery and other scripts -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="\{\{ \'/assets/js/jquery-1.11.2.min.js\' | prepend: site.baseurl \}\}"><\/script>')</script>
<script src="/assets/js/dropcap.min.js"></script>
<script src="/assets/js/responsive-nav.min.js"></script>
<script src="/assets/js/scripts.js"></script>


</body>

</html>
